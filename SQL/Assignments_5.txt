1 . list all the books that are written by Author Loni and has price   
less then 600. 
->mysql> select Book_name from books
    -> where Author_name="Loni" and cost<600;

2. list the Issue details for the books that are not returned yet. 
->  mysql> select * from issue
    -> where Return_date is null;
Empty set (0.00 sec)

3. Update all the blank return_date with 31-Dec-06 excluding 7005 
and 7006. 
->  update issue 
set return_date="2006-12-31"
where Lib_issue_id in(7005,7006);

4.List all the Issue details that have books issued for more then 30 
days. 

->  select * from issue
    -> where datediff(Issue_date,Return_date)>30;


5 .List all the books that have price in range of 500 to 750 and has 
category as Database. 
-> select  Book_no from books where category='Database' and cost between 500 and 750;

6 .List all the books that belong to any one of the following 
categories Science, Database, Fiction, Management. 
-> select * from books where category in(categories Science, Database, Fiction, Management);

7.List all the members in the descending order of Penalty due on 
them. 
->select * from members
    -> order by penality_Amount desc;

8 .Modify the price of book with id 103 to Rs 300 and category to  
RDBMS.   update books
    -> set cost=300 ,category='RDBMS' where book_no=103 ;

9 .List all the books in ascending order of category and descending 
order of price.
 select * from books
    -> order by category asc,cost desc;

10 .List all the books that contain word SQL in the name of the book. 
->
 select Book_name from books
    -> where Book_name like '%SQL%';

11. List the Lib_Issue_Id, Issue_Date, Return_Date and No of days  
Book was issued.
select member_id,datediff(Issue_date,Return_date) as "no of days" from issue;


12.Find the details of the member of the Library in the order of their  
joining the library. 


mysql> select * from members
    -> order by Acc_open_date;

13. Display the count of total no of books issued to Member 101.
select count( Lib_issue_id) from issue
    -> where member_id=10;

14.Display the total penalty due for all the members.
-> select sum(panelty) from members;



15. Display the total no of members 
->   select count(*) from members;

16. Display the total no of books issued
-> select count(Lib_issue_id) from issue;  


17.Display the average membership fees paid by all the members .
->  select avg(fess_paid) from members;

18. List the various categories and count of books in each category

 select category,count( Book_no) from books
    -> group by category;


19 List the book_No and the number of times the book is issued in the 
descending order of count. 

->      select category,count(distinct Book_no) from books
    -> group by category;


20) Find the maximum, minimum, total and average penalty amount in 
the member table. 
-> 
mysql> select max(penality_Amount) as max_panalty ,min(penality_Amount) as  min_panalty,avg(penality_Amount) as avg_panalty from members;
 
21) Display the member id and the no of books for each member that 
has issued more then 2 books. 
->  select Member_id,count(Books_no) from issue
    -> group by Member_id
    -> having  count(Books_no)>2;
Empty set (0.00 sec)

22) Display the member id, book no and no of times the same book is 
issued by the member in the descending order of count. 
->     select Member_id,Books_no,count(Books_no) from issue
    -> group by Member_id,Books_no
    -> order by Member_id desc;


23) Display the month and no of books issued each month in the 
descending order of count. 
->  mysql> select month(Issue_date) as issue_month,count(month(Issue_date from issue
 -> group by month(Issue_date) 
-> order by count(month(Issue_date)) desc;

 

24)List the book_no of all the books that are not issued to any   
member so far.

->   select b.Book_no,i.Member_id from books as b left join issue as i on
    -> b.Book_no=i.Books_no
      where i.Member_id is null;

25).List all the member id that exist in member table and has also at 
least one book issued by them.  
->
 select * from issue where member_id in( select member_id from members);

26).List all the member id that exist in member table and has also at 
least one book issued by them.
->    select m.member_id,i.member_id  from members as m left join issue as i
    -> on m.member_id=i.member_id
    -> where m.member_id is not null;

27).List all the Issue_details for books issued in December and July 
without using any arithmetic, Logical or comparison operator. 
  
-> select  Lib_issue_id,month(Issue_date) from issue
    -> where month(Issue_date) in(12,7);

 
28 ).List the Book_No, Book_Name and Issue_date for all the books 
that are issued in month of December and belong to category Database. 
-> select i.Book_no,i.Issue_date,b.book_name from issue as i inner join books as b
    -> on i.Book_no=b.Book_no
    -> where month(Issue_date)=12 and b.category="Database";
    

29).List the Member Id, Member Name and max books allowed in the 
descending order of the max books allowed. 
-> select member_id,member_name,max_books_allowed from members
    -> order by max_books_allowed desc;



30).List the Book No, Book Name, Issue_date and Return_Date for all 
the books issued by Richa Sharma. 
-> 
     
     





31).




32).List all the books that have highest price in their own category.

 select category,max(cost) as max_cost from books
    -> group by category;

33).List all the Issue_Details where Issue_date is not within the 
Acc_open_date and Return_date for that member. 
->     





34).List all the members that have not issued a single book so far. 
-> select m.member_id,i.Book_no from members  as m left join  issue as i
    -> on m.member_id=i.member_id
    -> where i.member_id is null;

35).



36)List the Book_Name, Price of all the books that are not returned 
for more then 30 days. 
-> select b.Book_name,b.cost
    -> from books as b
    -> join issue as i on b.Book_no=i.Book_no
    -> where Datediff(Issue_date,i.Return_date)>=30;




37).List all the authors and book_name that has more then 1 book 
written by them.
->



38).List the Member ID, Member Name of the people that have issued 
the highest and the lowest no of books. 
->


39).List the details of highest 3 priced books. 

-> select * from books
    -> order by cost desc limit 3;

40).List the total cost of all the books that are currently issued but not returned.
->
select sum(cost) from books where Book_no in (select Book_no from issue where Return_date is  null);

41).List the details of the book that has been issued maximum no of times.
->


42).List how many books are issued to lifetime members. 
->  select count(Book_no) from members as m inner join issue as i
    -> on m.member_id=i.member_id
    -> where membership_type="lifetime";


43).List all member types and how many members are there in each type   
 mysql> select membership_type,count(member_id) from members 
-> group by membership_type;

45).List first 5 members who had joined library. 
->
select member_name from members
    -> order by member_id limit 5;


46).list all the members who have not returned books yet. 
select member_id from issue where Return_date>curdate();




51).list all lifetime members who joined library during 1st January 2006 to 31st December 2006 but issued only one book.
->   select m.member_id,count(Book_no) from members as m
    -> inner join issue as i
    -> on m.member_id=i.member_id
    -> where membership_type="Lifetime" and Acc_open_date between "2006-01-01" and "2006-12-31"
    -> group by member_id
    -> having count(Book_no)=1;
Empty set (0.00 sec)

52). Modify the Penalty_Amount for Garima Sen to Rs 100.
 update members
    -> set penality_Amount=300 where member_name="Garima";
